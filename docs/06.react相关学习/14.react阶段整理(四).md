---
title: 14.reacté˜¶æ®µæ•´ç†(å››)(ç³»ç»Ÿæ•´ç†)
sidebar: auto
date: 2021-09-03 00:00:00
tags:
  - reacté˜¶æ®µæ•´ç†(å››)
categories:
  - reactç›¸å…³å­¦ä¹ 
---

> æ¥é˜¶æ®µæ•´ç†ä¸‰

## 1.lazyLadod
- ä¸ºäº†æ€§èƒ½æå‡ï¼Œä»è€Œä½¿å¾—ç”¨åˆ°ç»„ä»¶çš„æ—¶å€™å†å»åŠ è½½ç»„ä»¶çš„èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨`æ‡’åŠ è½½`æ¥å®ç°
### æ‡’åŠ è½½å¼•å…¥ç»„ä»¶æ–¹æ³•ä¸€
```js
//å¼•å…¥lazy
import React, { Component,lazy,Suspense} from 'react'
//lazyå¼•å…¥ç»„ä»¶
const About = lazy(()=> import('./About'))
//æ­£å¸¸å¼•å…¥åŠ è½½ç»„ä»¶
import Loading from './Loading'

//åœ¨æ‡’åŠ è½½çš„æ—¶å€™å½¢æˆä¸€ä¸ªåŠ è½½ç”»é¢ï¼Œä½¿ç”¨Suspenseæ¥ç»™è·¯ç”±ç»‘ä¸ŠåŠ è½½ç”»é¢
<Suspense fallback={<Loading/>}>
    {/* æ³¨å†Œè·¯ç”± */}
    <Route path="/about" component={About}/>
</Suspense>
```


### æ‡’åŠ è½½å¼•å…¥ç»„ä»¶æ–¹æ³•äºŒ
```js
//å¼•å…¥lazy
import React, { Component,lazy,Suspense} from 'react'
//æ­£å¸¸å¼•å…¥åŠ è½½ç»„ä»¶
import Loading from './Loading'
//lazyå¼•å…¥ç»„ä»¶
const About = lazy(()=> import('./About'))

//å®šä¹‰æ‡’åŠ è½½åŠ¨ç”»æ¡†æ¶SuspenseComponent
const SuspenseComponent = (Component) => (props) => {
  return (
    <Suspense fallback={<Loading/>}>
      <Component {...props}></Component>
    </Suspense>
  );
};

//ä½¿ç”¨
 <Route path="/about" component={SuspenseComponent(About)}/>
```

### exactçš„ä½œç”¨
å…³äºRouteçš„exact,åŠ ä¸Šexactä»£è¡¨å½“å‰è·¯ç”±pathçš„è·¯å¾„é‡‡ç”¨ç²¾ç¡®åŒ¹é…ï¼Œæ¯”å¦‚è¯´Homeçš„pathå¦‚æœä¸åŠ ä¸Šexact,é‚£ä¹ˆpath="/about"å°†ä¼šåŒ¹é…ä»–è‡ªå·±ä¸path="/â€œè¿™ä¸¤ä¸ªï¼Œæ‰€ä»¥ä¸€èˆ¬path=â€/"è¿™ä¸ªè·¯ç”±ä¸€èˆ¬ä¼šåŠ ä¸Šexactï¼Œå¦å¤–éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯:**åµŒå¥—è·¯ç”±ä¸è¦åŠ exactå±æ€§**ï¼Œå¦‚æœçˆ¶çº§è·¯ç”±åŠ ä¸Šï¼Œè¿™é‡Œä¾‹å¦‚topicsåŠ ä¸Šè¯¥å±æ€§ï¼Œä»–ä¸‹é¢çš„å­è·¯ç”±å°†ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸ºå¤–å±‚å¼ºåˆ¶åŒ¹é…äº†ã€‚


## 2.å†æ¬¡å¤ä¹ hooks
### 1.useState
ç›¸å½“äºç±»ç»„ä»¶ä¸­çš„ `state` å’Œ `setState` çš„ç»“åˆ
```js
import {useState} from 'react'

function Page(){
    //è®¾ç½®numå€¼
    const [num,setNum] = useState(0)
    const newNum=3
    setNum(newNum) //æ™®é€šåšæ³•:æ›´æ”¹numå€¼ä¸º3
    setNum((oldVal)=>{ 
        return newNum //å‡½æ•°åšæ³•:æ›´æ”¹numä¸º3,è¿™é‡Œçš„oValä¸ºåŸæ¥çš„å€¼ï¼Œç„¶åå› ä¸ºæ˜¯å›è°ƒå‡½æ•°ï¼Œè¿˜å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œreturnä¸ºè¿”å›å€¼
    })
}
```

### 2.useEffect
1. + å¯ä»¥æŠŠ useEffect Hook çœ‹åšå¦‚ä¸‹ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆ
        - componentDidMount()
        - componentDidUpdate()
    	- componentWillUnmount() 

2. `useEffect`å¯ä»¥æ¥å—2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºå‡½æ•°ï¼Œç¬¬äºŒä¸ªä¸ºç›‘å¬å‚æ•°ï¼Œé»˜è®¤ä¸ä¼ çš„è¯ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸéƒ½æ‰§è¡Œ

3. `componentDidMount()`ç”¨æ³•ï¼šç¬¬äºŒä¸ªå‚æ•°ä¼ []ï¼Œé‚£å°±åªæ‰§è¡ŒcomponentDidMount
```js
//useEff
useEffect(()=>{
  ...todo
},[])
```

4. `componentDidUpdate()`ç”¨æ³•:ç¬¬äºŒä¸ªå‚æ•°ä¼ å¯¹åº”è¦ç›‘å¬çš„å±æ€§
```js
 useEffect(()=>{
    ...todo
},[value]) //ä¼šæ‰§è¡Œä¸€écomponentDidMountåç›‘å¬valueå€¼æ”¹å˜å¦ï¼Œæ”¹å˜äº†å°±æ‰§è¡Œtodo
```

5. `componentWillUnmount()`ç”¨æ³•:å¤„äºè¿”å›å‡½æ•°ä½ç½®
```js
 useEffect(()=>{
    return ()=>{...todo} //è¿™é‡Œå°±æ˜¯å¸è½½ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ‰€åœ¨
},[value])
```

### 3.useRef
1. + åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ref:`useRef`
   - åœ¨æ ‡ç­¾å†…ç›´æ¥ä½¿ç”¨useRef
```js
const firstRef =useRef()
<div ref={firstRef}>æ ‡ç­¾æµ‹è¯•<div> 

console.log(firstRef.current.textContent) == æ ‡ç­¾æµ‹è¯•
```
   - åœ¨å­ç»„ä»¶æ˜¯ç±»ç»„ä»¶ä¸­ä½¿ç”¨useRef()
```js
const firstRef =useRef()
<A ref={firstRef}></A>
è¾“å‡º:Aç±»ç»„ä»¶çš„`props`,`state`
```

   - åœ¨å­ç»„ä»¶æ˜¯å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨useRef()
```js
const firstRef =useRef()
<B ref={firstRef}></B>

//B.jsx
import {useState,forwardRef} from 'react'
const B=forwardRef((props,ref)=>{
    const [name,setName] =useState('Bæµ‹è¯•')
    return(
        <div ref={ref}>{name}</div>
    )
})
export default B

console.log(firstRef.current.textContent) == Bæµ‹è¯•
```

2. åœ¨ç±»ç»„ä»¶ä¸­ä½¿ç”¨ref:`React.createRef()`
```js
class Test extents React.Compent{
    myRef=React.createRef() 
    render(){
        return(
            <div ref={this.myRef}>ç±»æµ‹è¯•</div>
        )
    }
    console.log(this.myRef2.current.value) //ç±»æµ‹è¯•
}
```
:::tip
è¿™é‡Œå†æ¬¡æä¸€ä¸‹ï¼Œå‡½æ•°ç»„ä»¶refä½¿ç”¨`å†…è”å‡½æ•°`ä¼šå½±å“æ€§èƒ½,éœ€è¦ä½¿ç”¨`å¤–è”`
```js
saveInput = (c)=>{
    this.input1 = c;
    console.log('@',c);
}

render(){
    const {isHot} = this.state
    return(
        <div>
            {/*<input ref={(c)=>{this.input1 = c;console.log('@',c);}} type="text"/><br/><br/>*/}
            {/*å†…è”å‡½æ•°ä¼šæ‰§è¡Œn+1æ¬¡å‡½æ•°ï¼Œå½±å“æ€§èƒ½*/}
            <input ref={this.saveInput} type="text"/><br/><br/>
        </div>
    )
}
```
:::



## 3.Fragment
ä»£ç ç‰‡æ®µ,å› ä¸ºjsxè¯­æ³•è§„åˆ™ï¼Œå­ç»„ä»¶æœ€ä¸Šå±‚ä¸èƒ½ç›´æ¥ä¸ºå…ƒç´ 
```js
import React, { Component } from 'react';

class Hooks2 extends Component {
    render() {
        return (
            <div>
               <button>1</button> 
               <button>1</button> 
            </div>
        );
    }
}

export default Hooks2;

//è¿™æ ·ä¼šä½¿å¾—å±‚çº§å¤šä¸€ä¸ªdiv

//è§£å†³æ–¹æ¡ˆâœ¨âœ¨âœ¨âœ¨âœ¨âœ¨
import {Fragment} from 'react'
render() {
        return (
            <Fragment>
               <button>1</button> 
               <button>1</button> 
            </Fragment>
        );
    }
//ç­‰åŒäº
render() {
        return (
            <>
               <button>1</button> 
               <button>1</button> 
            </>
        );
    }
```
:::tip
`Fragment`å’Œ`<>`çš„åŒºåˆ«ï¼Œ`Fragment`å¯ä»¥æœ‰`key`å€¼ï¼Œç¡®ä¿å”¯ä¸€æ€§ï¼Œæ¸²æŸ“æ—¶å€™ä¸æ··ä¹±ï¼Œ<>ä¸å¯ä»¥æœ‰
:::




## 4.ç¥–å­™é€šä¿¡:createContextå’ŒuseContext
> ä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼, å¸¸ç”¨äºã€ç¥–ç»„ä»¶ã€‘ä¸ã€åä»£ç»„ä»¶ã€‘é—´é€šä¿¡

### ä½¿ç”¨

```js
1) åˆ›å»ºContextå®¹å™¨å¯¹è±¡ï¼š
	const XxxContext = React.createContext()  
	
2) æ¸²æŸ“å­ç»„æ—¶ï¼Œå¤–é¢åŒ…è£¹xxxContext.Provider, é€šè¿‡valueå±æ€§ç»™åä»£ç»„ä»¶ä¼ é€’æ•°æ®ï¼š
    //å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨xxxContext.Provider
	<xxxContext.Provider value={æ•°æ®}>
		å­ç»„ä»¶
    </xxxContext.Provider>
    
3) åä»£ç»„ä»¶è¯»å–æ•°æ®ï¼š

	//ç¬¬ä¸€ç§æ–¹å¼:ä»…é€‚ç”¨äºç±»ç»„ä»¶  //å£°æ˜æ¥æ”¶context
	  static contextType = xxxContext  // å£°æ˜æ¥æ”¶context
	  this.context // è¯»å–contextä¸­çš„valueæ•°æ®
	  
	//ç¬¬äºŒç§æ–¹å¼: å‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶éƒ½å¯ä»¥
	  <xxxContext.Consumer>
	    {
	      value => ( // valueå°±æ˜¯contextä¸­çš„valueæ•°æ®
	        è¦æ˜¾ç¤ºçš„å†…å®¹
	      )
	    }
	  </xxxContext.Consumer>
```

### æ³¨æ„
åœ¨åº”ç”¨å¼€å‘ä¸­ä¸€èˆ¬ä¸ç”¨context, ä¸€èˆ¬éƒ½å®ƒçš„å°è£…reactæ’ä»¶

### è¿™é‡Œæä¸€ä¸‹reactåæ¥å‡ºçš„hooks useContext
ç”¨äºåœ¨å‡½æ•°å¼çš„å­™ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œè®©å…¶å¯ä»¥ç›´æ¥å®šä¹‰`context`æ•°æ®ï¼Œä¸éœ€è¦ä½¿ç”¨æ¶ˆè´¹è€…`Consumer`
```js
import React, {useContext} from 'react'
function C(){
    //è¿™é‡Œç›´æ¥ä½¿ç”¨useContextç»™valèµ‹å€¼ç¥–ç»„ä»¶ä¼ è¿‡æ¥çš„å€¼
    const val=useContext(MyContext) //{username: "tom", age: 18}
	return (
		<div className="grand">
			<h3>æˆ‘æ˜¯Cç»„ä»¶</h3>
			<h4>æˆ‘ä»Aç»„ä»¶æ¥æ”¶åˆ°çš„ç”¨æˆ·å:
            {/*è¿™é‡Œæ˜¯æ™®é€šå£°æ˜ä½¿ç”¨ä¾›åº”è¿‡æ¥çš„æ•°æ®*/}
			<MyContext.Consumer>
				{value => `${value.username},å¹´é¾„æ˜¯${value.age}`}
			</MyContext.Consumer>
			</h4>
		</div>
	)
}
```



## 5.ç»„ä»¶ä¼˜åŒ–

### Componentçš„2ä¸ªé—®é¢˜ 

> 1. åªè¦æ‰§è¡ŒsetState(),å³ä½¿ä¸æ”¹å˜çŠ¶æ€æ•°æ®, ç»„ä»¶ä¹Ÿä¼šé‡æ–°render()
>
> 2. åªå½“å‰ç»„ä»¶é‡æ–°render(), å°±ä¼šè‡ªåŠ¨é‡æ–°renderå­ç»„ä»¶ ==> æ•ˆç‡ä½

### æ•ˆç‡é«˜çš„åšæ³•

>  åªæœ‰å½“ç»„ä»¶çš„stateæˆ–propsæ•°æ®å‘ç”Ÿæ”¹å˜æ—¶æ‰é‡æ–°render()

### åŸå› 

>  Componentä¸­çš„shouldComponentUpdate()æ€»æ˜¯è¿”å›true

### è§£å†³
```js
	åŠæ³•1: 
		é‡å†™shouldComponentUpdate(nextProps,nextState)æ–¹æ³•
		æ¯”è¾ƒæ–°æ—§stateæˆ–propsæ•°æ®, å¦‚æœæœ‰å˜åŒ–æ‰è¿”å›true, å¦‚æœæ²¡æœ‰è¿”å›false
	åŠæ³•2:  
		ä½¿ç”¨ PureComponent
		PureComponenté‡å†™äº†shouldComponentUpdate(nextProps,nextState), åªæœ‰stateæˆ–propsæ•°æ®æœ‰å˜åŒ–æ‰è¿”å›true
		æ³¨æ„: 
			åªæ˜¯è¿›è¡Œstateå’Œpropsæ•°æ®çš„æµ…æ¯”è¾ƒ, å¦‚æœåªæ˜¯æ•°æ®å¯¹è±¡å†…éƒ¨æ•°æ®å˜äº†, è¿”å›false  
			ä¸è¦ç›´æ¥ä¿®æ”¹stateæ•°æ®, è€Œæ˜¯è¦äº§ç”Ÿæ–°æ•°æ®
	(é¡¹ç›®ä¸­ä¸€èˆ¬ä½¿ç”¨PureComponentæ¥ä¼˜åŒ–)
```
:::tip
åœ¨ class component æ—¶ä»£ï¼Œä¸ºäº†æ€§èƒ½ä¼˜åŒ–æˆ‘ä»¬ç»å¸¸ä¼šé€‰æ‹©ä½¿ç”¨ PureComponent,æ¯æ¬¡å¯¹ props è¿›è¡Œä¸€æ¬¡æµ…æ¯”è¾ƒï¼Œå½“ç„¶ï¼Œé™¤äº† PureComponent å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ shouldComponentUpdate ä¸­è¿›è¡Œæ›´æ·±å±‚æ¬¡çš„æ§åˆ¶ã€‚
:::

### ğŸŒŸå‡½æ•°ç»„ä»¶ç»„ä»¶ä¼˜åŒ–
#### å‡½æ•°ç»„ä»¶æœ‰é’©å­memo
```js
import {memo} from 'react'

function ChildA(){
    console.log('childA-render')
    return(
        <div>ChildA</div>
    )
}

//æ˜¯å¦ç›¸åŒ
function areEqual(prevProps, nextProps) {
    //prevProps:æ—§çš„propsï¼ŒnextProps:æ–°çš„props
    if(prevProps.xxx ==nextProps.xxx ){
        return true //è¿”å›trueä¸ºä¸æ›´æ–°
    }else{
        return false //è¿”å›falseä¸ºæ›´æ–°
    }
  }

//memoæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºç»„ä»¶ï¼Œç¬¬äºŒä¸ªä¸ä¼ çš„æ—¶å€™ç›¸å½“äºPureComponentçš„æµ…æ¯”è¾ƒï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œè¿›è¡Œæ·±æ¯”è¾ƒï¼Œè¿”å›trueä¸ºä¸æ›´æ–°ï¼Œè¡¨ç¤ºå‰åç›¸åŒï¼Œè¿”å›falseä¸ºæ›´æ–°
export default memo(ChildA,areEqual)
```
:::tip
`useMemo`:åªæœ‰å½“`useMemo`ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­åŒ…å«æ”¹å˜äº†çš„å€¼çš„æ—¶å€™é¡µé¢æ‰ä¼šé‡æ–°æ¸²æŸ“,ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼Œå¯ä»¥å¤šä¸ªå€¼
```js
import {useMemo} from 'react'

function ChildA(props){
    console.log('childA-render')
    return useMemo(()=>{
        return(
            <div>{props.name}:{props.num}</div>
        )
    },[props.num])
   //åªæœ‰åœ¨ props.numæ”¹å˜åæ‰ä¼šé‡æ–°æ¸²æŸ“é¡µé¢ï¼Œä¹Ÿå°±æ˜¯æ”¹å˜äº†nameä¸ä¼šé‡æ–°æ¸²æŸ“é¡µé¢ï¼Œåªæœ‰æ”¹å˜äº†numæ‰ä¼šå¸¦ç€nameæ–°å€¼é‡æ–°æ¸²æŸ“
}
export default ChildA
```
:::



## 6.render props(ä¹Ÿå¯ä»¥è§09æ–‡ç« )
æ•´ç†å½’çº³
### å¦‚ä½•å‘ç»„ä»¶å†…éƒ¨åŠ¨æ€ä¼ å…¥å¸¦å†…å®¹çš„ç»“æ„(æ ‡ç­¾)?

	Vueä¸­: 
		ä½¿ç”¨slotæŠ€æœ¯, ä¹Ÿå°±æ˜¯é€šè¿‡ç»„ä»¶æ ‡ç­¾ä½“ä¼ å…¥ç»“æ„  <AA><BB/></AA>
	Reactä¸­:
		ä½¿ç”¨children props: é€šè¿‡ç»„ä»¶æ ‡ç­¾ä½“ä¼ å…¥ç»“æ„
		ä½¿ç”¨render props: é€šè¿‡ç»„ä»¶æ ‡ç­¾å±æ€§ä¼ å…¥ç»“æ„, ä¸€èˆ¬ç”¨renderå‡½æ•°å±æ€§

### children props

	<A>
	  <B>xxxx</B>
	</A>
	{this.props.children}
	é—®é¢˜: å¦‚æœBç»„ä»¶éœ€è¦Aç»„ä»¶å†…çš„æ•°æ®, ==> åšä¸åˆ° 

### render props

	<A render={(data) => <C data={data}></C>}></A>
	Aç»„ä»¶: {this.props.render(å†…éƒ¨stateæ•°æ®)}
	Cç»„ä»¶: è¯»å–Aç»„ä»¶ä¼ å…¥çš„æ•°æ®æ˜¾ç¤º {this.props.data} 


ä¸ªäººç»“åˆvueç†è§£:å¸¦å‚æ•°çš„æ’æ§½
### ä½¿ç”¨
```js
//child.js
const value={name:'111'}
<div>{this.props.render(value)}</div>

//parent.js
<Child render={(val)=><div>{val.name}</div>></Child> //æ˜¾ç¤ºä¸º111
```


## 6.ç»„ä»¶é€šä¿¡(å…„å¼Ÿä¹‹é—´)
ç›¸å½“äºvueä¸­çš„äº‹ä»¶æ€»çº¿bus
### å€ŸåŠ©æ’ä»¶ pubsub-js
- PubSub.publish('äº‹ä»¶å',data):å‘å¸ƒ
- PubSub.subscribe('äº‹ä»¶å',(name,val)=>{..todo}):è®¢é˜…ï¼Œå‚æ•°nameä¸ºäº‹ä»¶åï¼Œvalä¸ºä¼ å€¼
```js
import PubSub from "pubsub-js";
//A.jsx
class A extends React.Component{
    giveB(){
        PubSub.publish('send',{data:'Aä¼ æ¥çš„å€¼'})
    }
}

//B.jsx
class B extends React.Component{
    constructor(){
        PubSub.subscribe('send',(name,val)=>{
           console.log(name)  //send
           console.log(val)   //{data:'Aä¼ æ¥çš„å€¼'}
        })
    }
}
```

### å€ŸåŠ©æ’ä»¶ events
- bus.emit('äº‹ä»¶å',data):å‘å¸ƒ
- bus.on('äº‹ä»¶å',(val)=>{..todo}):è®¢é˜…ï¼Œå‚æ•°valä¸ºä¼ å€¼
```js
import {EventEmitter} from 'events'

var bus = new EventEmitter()  //æ³¨å†Œä¸€ä¸ªæ€»çº¿
//A.jsx
class A extends React.Component{
    giveB(){
        bus.emit('send',{data:'Aä¼ æ¥çš„å€¼'})
    }
}

//B.jsx
class B extends React.Component{
    constructor(){
        bus.on('send',data=>{
            console.log(data)  //{data:'Aä¼ æ¥çš„å€¼'}
        })
    }
}
```

### çˆ¶ç»„ä»¶è·å–å­ç»„ä»¶æ–¹æ³•
```js
åœ¨å­ç»„ä»¶ä¸Šå®šä¹‰ä¸€ä¸ªæ–¹æ³•
 //å¿…é¡»åœ¨è¿™é‡Œå£°æ˜ï¼Œæ‰€ä»¥ ref å›è°ƒå¯ä»¥å¼•ç”¨å®ƒ
      componentDidMount(){
        //å¿…é¡»åœ¨è¿™é‡Œå£°æ˜ï¼Œæ‰€ä»¥ ref å›è°ƒå¯ä»¥å¼•ç”¨å®ƒ
        this.props.onRef(this)
    }
//ç›´æ¥åœ¨ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œ,ç„¶ååœ¨çˆ¶ç»„ä»¶æ‹¿åˆ°å®šä¹‰åˆ°çˆ¶ç»„ä»¶çš„å€¼ä¸Š
 <Child onRef={this.onRef} />
  onRef = (ref) => {
        this.child = ref
    }
è¿™æ—¶å€™this.childä¸Šå°±æœ‰å­ç»„ä»¶çš„å€¼äº†
```


## 7.é”™è¯¯è¾¹ç•Œ
### ç†è§£:

é”™è¯¯è¾¹ç•Œï¼šç”¨æ¥æ•è·åä»£ç»„ä»¶é”™è¯¯ï¼Œæ¸²æŸ“å‡ºå¤‡ç”¨é¡µé¢

### ç‰¹ç‚¹ï¼š

åªèƒ½æ•è·åä»£ç»„ä»¶ç”Ÿå‘½å‘¨æœŸäº§ç”Ÿçš„é”™è¯¯ï¼Œä¸èƒ½æ•è·è‡ªå·±ç»„ä»¶äº§ç”Ÿçš„é”™è¯¯å’Œå…¶ä»–ç»„ä»¶åœ¨åˆæˆäº‹ä»¶ã€å®šæ—¶å™¨ä¸­äº§ç”Ÿçš„é”™è¯¯

### ä½¿ç”¨æ–¹å¼ï¼š

getDerivedStateFromErroré…åˆcomponentDidCatch

```js
state = {
		hasError:'' //ç”¨äºæ ‡è¯†å­ç»„ä»¶æ˜¯å¦äº§ç”Ÿé”™è¯¯
	}
// ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¸€æ—¦åå°ç»„ä»¶æŠ¥é”™ï¼Œå°±ä¼šè§¦å‘
static getDerivedStateFromError(error) {
    console.log(error);
    // åœ¨renderä¹‹å‰è§¦å‘
    // è¿”å›æ–°çš„state
    return {
        hasError: true,
    };
}

componentDidCatch(error, info) {
    // ç»Ÿè®¡é¡µé¢çš„é”™è¯¯ã€‚å‘é€è¯·æ±‚å‘é€åˆ°åå°å»
    console.log(error, info);
}

render() {
		return (
			<div>
				<h2>æˆ‘æ˜¯Parentç»„ä»¶</h2>
				{this.state.hasError ? <h2>å½“å‰ç½‘ç»œä¸ç¨³å®šï¼Œç¨åå†è¯•</h2> : <Child/>}
			</div>
		)
	} //è¿™é‡Œçœ‹å‡ºäº†ï¼Œå‡ºç°é”™è¯¯æ—¶å€™å°±ä¼šæ˜¾ç¤ºh2ä¸æ˜¾ç¤ºå­ç»„ä»¶
```