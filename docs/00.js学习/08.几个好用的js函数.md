---
title: 08.几个好用的js函数
sidebar: auto
date: 2021-09-07 00:00:00
tags:
  - 好用的js函数
categories:
  - js学习
---




## 1.下载一个链接
同时适用于word,ppt等浏览器不会默认执行预览的文档,也可以用于下载后端接口返回的流数据
```js
// //下载一个链接 
function download(link, name) {
    if(!name){
            name=link.slice(link.lastIndexOf('/') + 1)
    }
    let eleLink = document.createElement('a')
    eleLink.download = name
    eleLink.style.display = 'none'
    eleLink.href = link
    document.body.appendChild(eleLink)
    eleLink.click()
    document.body.removeChild(eleLink)
}
// //



// //下载excel  下载后端返回的流
// download('http://111.229.14.189/file/1.xlsx')
```

## 2.自定义下载内容
```js

/**
 * 浏览器下载静态文件
 * @param {String} name 文件名
 * @param {String} content 文件内容
 */
 function downloadFile(name, content) {
    if (typeof name == 'undefined') {
        throw new Error('The first parameter name is a must')
    }
    if (typeof content == 'undefined') {
        throw new Error('The second parameter content is a must')
    }
    if (!(content instanceof Blob)) {
        content = new Blob([content])
    }
    const link = URL.createObjectURL(content)
    download(link, name)
}

function download(link, name) {
    if(!name){
            name=link.slice(link.lastIndexOf('/') + 1)
    }
    let eleLink = document.createElement('a')
    eleLink.download = name
    eleLink.style.display = 'none'
    eleLink.href = link
    document.body.appendChild(eleLink)
    eleLink.click()
    document.body.removeChild(eleLink)
}

//使用方式，下载一个JSON文件
downloadFile('1.txt','lalalallalalla')
downloadFile('1.json',JSON.stringify({name:'hahahha'})) //下载了一个json文件，内容是{name:'hahahha'}
```

## 3.cleanObject
去除对象中value为空(null,undefined,'')的属性,
- 举个例子
```js
let res=cleanObject({
    name:'',
    pageSize:10,
    page:1
})
console.log("res", res) //输入{page:1,pageSize:10}   name为空字符串，属性删掉
```
- 具体实现
```js
const isFalsy = (value) => (value === 0 ? false : !value);

const isVoid = (value) =>
  value === undefined || value === null || value === "";

//具体使用函数
const cleanObject = (object) => {
  // Object.assign({}, object)
  if (!object) {
    return {};
  }
  const result = { ...object };
  Object.keys(result).forEach((key) => {
    const value = result[key];
    if (isVoid(value)) {
      delete result[key];
    }
  });
  return result;
};

```


## 4.手写数组去重函数
思路，转为string后进行字段去重
```js
function arrayToHeavy(arr){
  let newArr=[]
  //转为string
  newArr=arr.map((item)=>JSON.stringify(item))
  //去重后转json
  let res=[...new Set(newArr).map((item2)=>JSON.parse(item2))]
  return res
}
```

## 5.数组扁平化函数
- 无视数据类型
```js
 var res = ['a','b',['c','d']].flat(Infinity)  //Infinity表示彻底扁平化，不填默认为1，也就是扁平化一级，可以填级数
     console.log(res) //['a','b','c','d']
```