(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{536:function(t,s,a){"use strict";a.r(s);var r=a(18),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-portals-插槽的一种形式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-portals-插槽的一种形式"}},[t._v("#")]),t._v(" 1.Portals(插槽的一种形式)")]),t._v(" "),a("p",[t._v("Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("ReactDOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPortal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("第一个参数（child）是任何可渲染的 "),a("code",[t._v("React")]),t._v(" 子元素，例如一个元素，字符串或 fragment。第二个参数（container）是一个 DOM 元素。"),a("br"),a("br")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("意思就是把父组件对于子组件的插槽渲染到父组件dom节点意外的地方"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("如父节点dom节点为root \n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" doc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPortal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mask"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"modal"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Modal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n会在root节点外创建一个空的"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 因为这里的"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node没有取名\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("h2",{attrs:{id:"_2-profiler-react探查器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-profiler-react探查器"}},[t._v("#")]),t._v(" 2.Profiler(react探查器)")]),t._v(" "),a("p",[t._v("React 16.5 新增了对开发工具（DevTools）性能分析插件（profiler plugin）的支持。该插件通过 React Profiler API（实验中）收"),a("code",[t._v("集每个组件渲染的耗时")]),t._v("，用于分析识别出 React 应用中的性能瓶颈。它与我们即将推出的 time slicing 和 suspense 这两个功能将完全兼容。")]),t._v(" "),a("h3",{attrs:{id:"使用性能分析插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用性能分析插件"}},[t._v("#")]),t._v(" 使用性能分析插件")]),t._v(" "),a("p",[t._v("DevTools 将为支持 Profiler API 的应用展示“Profiler”选项卡： "),a("br"),a("br")]),t._v(" "),a("p",[t._v("“Profiler”面板默认打开是空的。单击“录制”按钮开始录制："),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/0.png",alt:"插件所在.png"}}),a("br"),a("br")]),t._v(" "),a("p",[t._v("一旦开始录制，DevTools 将在每次应用渲染时自动收集性能信息。然后正常使用你的应用。单击“停止”按钮停止录制并分析。")]),t._v(" "),a("h3",{attrs:{id:"查看性能报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看性能报告"}},[t._v("#")]),t._v(" 查看性能报告")]),t._v(" "),a("h4",{attrs:{id:"commits-提交-报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commits-提交-报告"}},[t._v("#")]),t._v(" Commits(提交)报告")]),t._v(" "),a("p",[t._v("理论上，React 的工作分为两个阶段：")]),t._v(" "),a("ol",[a("li",[t._v("render（渲染）阶段，将决定是否需要更新 DOM。此时 React 调用render函数，然后将本次 render 函数的结果与上一次的结果进行比较。")]),t._v(" "),a("li",[t._v("commit（提交）阶段，当 React 做出更新 DOM 的操作（DOM 节点的增加，删除，修改等）时，此阶段还会调用componentDidMount，componentDidUpdate等与生命周期相关的函数。"),a("br"),a("br")])]),t._v(" "),a("p",[t._v("DevTools Profiler 通过“commits(提交)”对性能信息进行分组。commits (提交) 显示在 Profiler 顶部附近的条形图中：\n"),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/1.png",alt:"右上条形分组.png"}}),t._v("\n图表中的每个竖条表示一次 commit(提交)，当前"),a("code",[t._v("选中的")]),t._v(" commit(提交)颜色为"),a("code",[t._v("黑色")]),t._v("。可以通过单击竖条（或左/右箭头按钮）来选择其它的commit (提交)。"),a("br"),a("br")]),t._v(" "),a("p",[t._v("每个竖条的颜色和高度对应了本次 commit(提交)的渲染所需的时间（"),a("code",[t._v("较高的黄色")]),t._v("竖条比"),a("code",[t._v("较短的蓝色")]),t._v("竖条"),a("code",[t._v("耗时更长")]),t._v("）。")]),t._v(" "),a("h4",{attrs:{id:"过滤-commits"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#过滤-commits"}},[t._v("#")]),t._v(" 过滤 Commits")]),t._v(" "),a("p",[t._v("录制的时间越长，应用 "),a("code",[t._v("render")]),t._v(" 的次数就越多。有时候你可能会记录很多次的 "),a("code",[t._v("commits")]),t._v("。为了能让分析起来更方便，Profiler 提供了"),a("code",[t._v("过滤功能")]),t._v("。可以通过设定一个"),a("code",[t._v("阈值")]),t._v("，让 Profiler 隐藏所有比该值小的 "),a("code",[t._v("commits。")]),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/3.png",alt:"过滤Commits.png"}})]),t._v(" "),a("h4",{attrs:{id:"火焰图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#火焰图"}},[t._v("#")]),t._v(" 火焰图")]),t._v(" "),a("p",[t._v("火焰图表示某次特定 commits 对应的应用的状态。图中的每个横条代表一个 React 的组件（例如 App，Nav）。横条的大小和颜色表示渲染组件及其子组件所需的时间。（横条的宽度表示组件最后一次渲染时花费的时间，颜色表示作为本次 commit 的一部分所花费的时间。）\n"),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/2.png",alt:"火焰图.png"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[a("strong",[t._v("注意")]),a("br"),t._v("\n横条的宽度表示在最后一次渲染时渲染组件（及其子组件）所需的时间。如果组件未作为此次 commit 的一部分重新更新，则表示先前的时间。组件越宽，渲染耗时越长。")]),t._v(" "),a("p",[t._v("横条的颜色表示组件（及其子组件）在所选 commit 中渲染的耗时。黄色的组件耗时更多，蓝色的组件耗时较少，灰色组件表示在本次 commit 期间不需要渲染。")])]),t._v(" "),a("p",[t._v("例如，上面显示的 commit 总共需要 154.8 毫秒进行渲染。该 Home 组件的渲染耗时是最多的（耗时 154.8 毫秒）。剩下的时间消耗在剩余的子节点，或者在它自己的渲染方法中。"),a("br")]),t._v(" "),a("p",[t._v("你可以通过点击子组件来展开查看下面子组件的耗时，当然 点选组件时，在右侧面板中还会显示其 "),a("code",[t._v("props")]),t._v(" 和 "),a("code",[t._v("state")]),t._v(" 在 "),a("code",[t._v("commit")]),t._v(" 时的信息。你可以了解更详细的信息，帮你更好的分析组件在 "),a("code",[t._v("commit")]),t._v(" 期间实际呈现的内容：\n"),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/5.png",alt:"详情.png"}})]),t._v(" "),a("h4",{attrs:{id:"组件图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件图"}},[t._v("#")]),t._v(" 组件图")]),t._v(" "),a("p",[t._v("有时，可能需要查看某个特定组件在本次分析中一共渲染了多少次。组件图以柱状图的的形式呈现这个信息。图表中的每个竖条展示了组件每次渲染的耗时。颜色和高度表示组件相对于本次 commit 中的其他组件渲染的时间。\n"),a("img",{attrs:{src:"http://47.99.154.206:8010/Profiler(react%E6%8E%A2%E6%9F%A5%E5%99%A8)/6.png",alt:"组件图.png"}})]),t._v(" "),a("p",[t._v("上图显示表明，每次渲染时，"),a("code",[t._v("Tree")]),t._v("都是 commits 中最"),a("code",[t._v("“昂贵”")]),t._v("的组件（意味着它的耗时最长）。"),a("br"),a("br")]),t._v(" "),a("p",[t._v("要查看某次渲染的详细情况，可以双击组件或选择组件，然后单击右侧详细信息窗格中的"),a("code",[t._v("蓝色条形")]),t._v("图图标。并可以通过单击右侧详细信息窗格中的"),a("code",[t._v("“x”")]),t._v("按钮返回。双击详细中的内容可以查看有关本次 "),a("code",[t._v("commit")]),t._v(" 的更多信息。"),a("br"),a("br")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://developer.aliyun.com/article/713002",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文出处:"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);